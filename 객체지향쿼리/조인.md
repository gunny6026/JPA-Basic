# 조인

- ###내부 조인 :

select m from Member m  [INNER] JOIN m.team t

- ### 외부 조인 :

select m from Member m LEFT[OUTER] JOIN m.team t

- ### 세타 조인 : (연관관계가 전혀 없는데 한다, 일명 막 조인)

select count(m) from Member m , Team t where m.username = t.name



#### 내부 조인
```java
 Team team = new Team();
            team.setName("파리 생제르망망");
            em.persist(team);


            Member member = new Member();
            member.setUsername("음바페" );
            member.setAge(23);
            member.setTeam(team);

            em.persist(member);


            em.flush();
            em.clear();

            String query = "select m from Member m inner join m.team t";
            List<Member> resultList
            = em.createQuery(query, Member.class).getResultList();


            tx.commit();
```
여기서 inner는 생략 가능

*******
콘솔에서 쿼리를 살펴보면 

member와 team을 inner join을 사용해서 데이터를 가져왔다.

근데, 그 뒤로 또 team에 대한 select 문이 나왔다.

여기서 !! fetch 복습

```java
@ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "TEAM_ID")
    private Team team;
```

fetch LAZY 전략을 설정을 한 뒤 다시 실행하면

member와 team의 inner join 쿼리만 나오고

`그 뒤로 team에 대한 select 쿼리는 나오지 않는다. !!!`


#### 외부조인

```java
        String query = "select m from Member m left outer join m.team t";
        List<Member> resultList
        = em.createQuery(query, Member.class).getResultList();


            tx.commit();
```

여기서 outer는 생략 가능하다

*********

#### 세타조인

```java

          String query = "select m from Member m , Team t where m.username = t.name";
            List<Member> resultList
                    = em.createQuery(query, Member.class).getResultList();


            tx.commit();
```

### 조인 - ON 절

- ON절을 활용한 조인(JPA 2.1 부터 지원)
    - 조인 대상 필터링
    - 연관관계 없는 엔티티 외부 조인(하이버네이트 5.1부터)
    
#### 1. 조인 대상 필터링

- 예) 회원과 팀을 조인하면서, 팀 이름이 A인 팀만 조인
  
__JPQL:__
    
select m , t from Member m LEFT JOIN m.team t on t.name ='A'


__SQL:__

select m.* , t.* from Member m LEFT JOIN Team t ON m.TEAM_ID = t.id and t.name ='A'


```java
  String query = "select m from Member m left join m.team t on t.name ='teamA' ";
            List<Member> resultList
                    = em.createQuery(query, Member.class).getResultList();

```


#### 2.연관관계 없는 엔티티 외부 조인

- 예) : 회원의 이름과 팀의 이름이 같은 대상 외부 조인

__JPQL:__

select m , t from Member m LEFT JOIN Team t on m.username = t.name

__SQL:__

select m.* , t.* from Member m LEFT JOIN Team t ON m.username = t.name

```java
 Team team = new Team();
            team.setName("파리 생제르망");
            em.persist(team);


            Member member = new Member();
            member.setUsername("파리 생제르망" );
            member.setAge(23);
            member.setTeam(team);

            em.persist(member);


            em.flush();
            em.clear();

          String query = "select m from Member m left join Team t on m.username = t.name  ";
            List<Member> resultList
                    = em.createQuery(query, Member.class).getResultList();


            tx.commit();
```

멤버이름이 파리 생제르망이라고 일단 가정하고 조인 쿼리 실행

